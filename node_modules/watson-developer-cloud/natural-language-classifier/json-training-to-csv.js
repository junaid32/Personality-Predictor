
'use strict';

var stringify = require('csv-stringify');

function toCSVArray(data) {
  if (data.text && data.classes && data.classes.length > 0)
    return [data.text].concat(data.classes);
  else
    throw Error('Invalid training_data format, it needs to be: '+
      '[{ text: "my-text", classes:["my-class1", "my-class2",...]}, {}, ...]');
}

/**
 * IF traning is json, convert it to csv.
 * @param  {Object[]} jsonData the training_data as a json array
 * @param  {Function} cb the error first callback
 */
module.exports = function toCSV(training, cb) {
  if (Array.isArray(training)) {
    try {
      stringify(training.map(toCSVArray), cb);
    } catch (e) {
      cb(e);
    }
  } else
    cb(null, training);
};
